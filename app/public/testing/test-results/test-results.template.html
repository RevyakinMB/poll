<div class="test-results__row">
    <label translate>
        Testing name:
    </label>
    <span>
        {{ $ctrl.testing.idQuestionSet.name }}
    </span>
</div>
<div class="test-results__row">
    <label translate>
        Testing date:
    </label>
    <span>
        {{ $ctrl.testing.attempts[0].startedAt | date }}
    </span>
</div>
<div class="test-results__row hide-on-print"
     ng-if="!$ctrl.studentId">
    <span translate>Search by testee's name:</span>
    <input type="text" ng-model="$ctrl.qs"
           class="form-control test-results__search-input">
</div>
<div ng-repeat="r in $ctrl.results | filter: { name: $ctrl.qs }">
    <div class="test-results__row">
        <label translate>
            Name:
        </label>
        <a ng-href="/testResults/{{$ctrl.testing._id}}/{{r.attempt.idStudent}}">
            {{r.name}}
        </a>
    </div>
    <table ng-if="$ctrl.keysGet(r.sumByFactor).length &&
                r.attempt.finishedAt"
           class="test-results__table test-results__row">
        <thead>
        <tr>
            <td>
                <label translate>Index</label>
            </td>
            <td ng-repeat="f in $ctrl.factorSet.factors">
                {{f.index}}
            </td>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>
                <label translate>Sum</label>
            </td>
            <td ng-repeat="f in $ctrl.factorSet.factors">
                {{ r.sumByFactor[f._id] }}
            </td>
        </tr>
        </tbody>
    </table>
    <div ng-if="r.questionsCount" class="test-results__row">
        <label translate>
            Correct answers:
        </label>
        <span>
            {{ r.correctCount }} / {{ r.questionsCount }}
        </span>
    </div>
    <div ng-if="!r.attempt.finishedAt" class="test-results__row">
        <span>
            <span translate>
                Test passing is in progress:
            </span>
            {{r.attempt.results.length}}
            /
            {{$ctrl.testing.idQuestionSet.questions.length}}
        </span>
    </div>
    <hr>
</div>
<div ng-if="$ctrl.studentId &&
            $ctrl.results.length &&
            $ctrl.results[0].attempt.finishedAt &&
            $ctrl.keysGet($ctrl.results[0].stenByFactor).length"
     class="test-results__row">
    <table class="test-results__table">
        <thead>
            <tr>
                <td rowspan="2" class="test-results__table-head1">
                    <label translate>Low stens by factor</label>
                </td>
                <td colspan="10" class="test-results__table-head2">
                    <label translate>Sten</label>
                </td>
                <td rowspan="2" class="test-results__table-head1">
                    <label translate>High stens by factor</label>
                </td>
            </tr>
            <tr>
                <td ng-repeat="v in [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]"
                    class="test-results__table-head2">
                    {{v}}
                </td>
            </tr>
        </thead>
        <tbody>
        <tr ng-repeat="f in $ctrl.factorSet.factors">
            <td>
                {{f.nameNegative}}
            </td>
            <td ng-repeat="v in [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]">
                <span class="glyphicon glyphicon-ok"
                      ng-if="$ctrl.results[0].stenByFactor[f._id] == v">
                </span>
            </td>
            <td>
                {{f.namePositive}}
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div ng-bind="$ctrl.message.text"
     class="message message_hidden"
     ng-class="{
        'message_hidden': $ctrl.message.hidden,
        'bg-danger': $ctrl.message.error,
        'bg-success': !$ctrl.message.error
     }">
</div>

